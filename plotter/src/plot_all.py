from analyzer.src.analyze_cwe_in_critical import analyzeCweInCritical
from config import *

from bar import plot, plotDate, plotMultiDate, plotMultiDateStackBar, save
from pie import plotPie

if __name__ == "__main__":
    with open(analyzeCveCountByMonthJson, "r") as fp:
        x, y = json.load(fp)
    plt = plotDate("时间", x, "漏洞数目", y, title="2015~2022年所有平台每月发布的漏洞数目", xInterval=6)
    save(jpgs[0], plt)

    with open(analyzeCvssScoreByMonthJson, "r") as fp:
        data = json.load(fp)
        x, y = data["generalData"]
        dateX, dateYs = data["dataByMonth"]
    plt = plot("CVSS分数", x, "漏洞数目", y, title="各CVSS分数层次的漏洞数目")
    save(jpgs[1], plt)
    plt = plotMultiDateStackBar("时间", dateX, "漏洞数目", dateYs, x, xInterval=6, title="2015~2022年每月各CVSS分数层级漏洞分布")
    save(jpgs[2], plt)

    with open(analyzeAndroidSeverityByMonthJson, "r") as fp:
        data = json.load(fp)
        x, y = data["generalData"]
        dateX, dateYs = data["dataByMonth"]
    plt = plot("安卓定义的严重性", x, "漏洞数目", y, title="各个安卓定义的严重性层次的漏洞数目")
    save(jpgs[3], plt)
    plt = plotMultiDateStackBar("时间", dateX, "漏洞数目", dateYs, x, xInterval=6, title="2015~2022年每月各个安卓定义的严重性层次漏洞分布")
    save(jpgs[4], plt)

    with open(analyzePixelSeverityByMonthJson, "r") as fp:
        data = json.load(fp)
        x, y = data["generalData"]
        dateX, dateYs = data["dataByMonth"]
    plt = plot("Pixel定义的严重性", x, "漏洞数目", y, title="各个Pixel定义的严重性层次的漏洞数目")
    save(jpgs[5], plt)
    plt = plotMultiDateStackBar("时间", dateX, "漏洞数目", dateYs, x, xInterval=6, title="2015~2022年每月各个Pixel定义的严重性层次漏洞分布")
    save(jpgs[6], plt)

    with open(analyzeHuaweiSeverityByMonthJson, "r") as fp:
        data = json.load(fp)
        x, y = data["generalData"]
        dateX, dateYs = data["dataByMonth"]
    plt = plot("华为定义的严重性", x, "漏洞数目", y, title="各个华为定义的严重性层次的漏洞数目")
    save(jpgs[7], plt)
    plt = plotMultiDateStackBar("时间", dateX, "漏洞数目", dateYs, x, xInterval=6, title="2015~2022年每月各个华为定义的严重性层次漏洞分布")
    save(jpgs[8], plt)

    with open(analyzeSamsungSeverityByMonthJson, "r") as fp:
        data = json.load(fp)
        x, y = data["generalData"]
        dateX, dateYs = data["dataByMonth"]
    plt = plot("三星定义的严重性", x, "漏洞数目", y, title="各个三星定义的严重性层次的漏洞数目")
    save(jpgs[9], plt)
    plt = plotMultiDateStackBar("时间", dateX, "漏洞数目", dateYs, x, xInterval=6, title="2015~2022年每月各个三星定义的严重性层次漏洞分布")
    save(jpgs[10], plt)

    with open(analyzeTypeByMonthJson, 'r') as fp:
        data = json.load(fp)
        x, y = data["generalData"]
        dateX, dateYs = data["dataByMonth"]
    plt = plot("安卓安全公告定义的类型", x, "漏洞数目", y, title="安卓安全公告定义的各类型的漏洞数目")
    save(jpgs[11], plt)
    plt = plotMultiDateStackBar("时间", dateX, "漏洞数目", dateYs, x, xInterval=6, title="2015~2022年每月各个类型的漏洞数目")
    save(jpgs[12], plt)

    with open(analyzeCweJson, 'r') as fp:
        data = json.load(fp)
        x, y = data["allData"]
    plt = plotPie(x, y, title="归属于各CWE的漏洞数目")
    save(jpgs[13], plt)

    with open(analyzeCweInCriticalJson, 'r') as fp:
        data = json.load(fp)
        x, y = data["allData"]
    plt = plotPie(x, y, title="高危漏洞中归属于各CWE的高危漏洞数目")
    save(jpgs[14], plt)

    with open(analyzeAospJson, 'r') as fp:
        data = json.load(fp)
        x, y = data["data"]
    plt = plot('AOSP版本号', x, '数量', y, title="各AOSP版本披露的漏洞数目")
    save(jpgs[15], plt)
    with open(analyzeHuaweiVersionJson, 'r') as fp:
        data = json.load(fp)
        xE, yE = data["data"]["EMUI"]
        xM, yM = data["data"]["Magic UI"]
    plt = plot('华为EMUI版本号', xE, '数量', yE, title="各EMUI版本披露的漏洞数目")
    save(jpgs[16], plt)
    plt = plot('华为Magic UI版本号', xM, '数量', yM, title="各EMUI版本披露的漏洞数目")
    save(jpgs[17], plt)

    with open(analyzeSamsungVersionJson, 'r') as fp:
        data = json.load(fp)
        x, y = data["data"]
    plt = plot('版本号', x, '数量', y, title="三星在各版本披露的漏洞数目")
    save(jpgs[18], plt)
import re
import numpy as np
import matplotlib.pyplot as plt
import matplotlib.dates as mdates

# 柱状图
def drawSingleBar(xLabel: str, x: np.array, yLabel: str, y: np.array, title: str, saveTo: str):
    # 横坐标
    plt.xlabel(xLabel)

    # 纵坐标
    plt.ylabel(yLabel)
    x = np.array(range(len(xLabel)))
    plt.bar(x, y, 0.4)
    plt.savefig(saveTo + '.jpg')

def drawMultiBar(xLabel: str, x: np.array, yLabel: str, ys: list, barLabels: list, title: str):
    # 横坐标
    plt.xlabel(xLabel)

    # 纵坐标
    plt.ylabel(yLabel)

    # 标题
    plt.title(title)

    plt.bar(x + 0.2, [i for i in range(6,1,-1)], 0.4, color='orange', label='first')
    plt.bar(x - 0.2, [i for i in range(1, 11, 2)], 0.4, color='green', label='second')
    # plt.legend()
    # plt.show()
    plt.savefig('test.jpg')

def drawDate(xLabel: str, x: np.array, yLabel: str, y: np.array, barWidth: str, title: str, savePath: str, dateFormatter='%Y/%m'):

    plt.xlabel(xLabel)
    plt.ylabel(yLabel)
    plt.title(title)

    plt.gca().xaxis.set_major_formatter(mdates.DateFormatter(dateFormatter))
    plt.xticks(rotation=45)
    plt.bar(x, y, barWidth)
    plt.savefig(re.sub(r'\.jpg', '', savePath) + '.jpg')

def drawMultiDate(xLabel: str, x: np.array, yLabel, ys: list, savePath: str, barLabels=['type1', 'type2'], barWidth=0.4, title=None, dateFormatter="%Y/%m"):
    plt.xlabel(xLabel)
    plt.ylabel(yLabel)
    plt.title(title)
    # make Chinese valid
    plt.rcParams['font.sans-serif'] = ['SimHei']
    # Get original X: [0,1,2,...,n]
    pltX = np.array([i + 0. for i in range(len(x))])
    # paint label
    plt.bar(pltX + (barWidth / 2), ys[0], barWidth, color='orange', label=barLabels[0])
    plt.bar(pltX - (barWidth / 2), ys[1], barWidth, color='green', label=barLabels[1])
    # rotate string
    plt.xticks(rotation=45)
    # Substitute original X to x(made up of date str)
    plt.xticks(ticks=range(len(x)), labels=x)
    # Add tags of barLabels
    plt.legend()
    # Save as JPG
    plt.savefig(re.sub(r'\.jpg', '', savePath) + '.jpg', dpi=200, bbox_inches='tight')


if __name__ == '__main__':
    x = ["2000/01", '2000/02', '2000/03', '2000/04']
    ys = [np.array([3,4,1,8]), np.array([2, 5,4,5])]
    barLabels = ['第一种', '第二种']
    drawMultiDate('时间', x, '数量', ys, 'test', barLabels=barLabels, title='标题')

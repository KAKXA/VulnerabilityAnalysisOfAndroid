from analyzer.src.utils.check_is_critical import isCritical
from analyzer.src.utils.get_all_cwe_list import getAllCweList

def analyzeCwe(cveList):
	allCnt = 0
	allCweList = getAllCweList(cveList)
	x = allCweList
	cweMap = dict()
	for i, cwe in enumerate(allCweList):
		cweMap[cwe] = i
	y = [0] * len(x)
	key = 'cweIds'

	for cveDict in cveList:
		val = cveDict[key]
		if val:
			for cweId in val:
				cweId = cweId.upper()
				allCnt += 1
				y[cweMap[cweId]] += 1
	return {'cveWithCwe': allCnt, 'allData': [x, y]}
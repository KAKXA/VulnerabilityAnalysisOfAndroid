from cleaner.src.utils.load import loadAll
from config import *
from scraper.src.utils.json_dump import jsonDump

from analyze_android_severity_by_month import analyzeAndroidSeverityByMonth
from analyze_android_stack_layer import analyzeAndroidStackLayer
from analyze_aosp import analyzeAosp
from analyze_cve_count_by_month import analyzeCveCountByMonth
from analyze_cvss_score_by_month import analyzeCvssScoreByMonth
from analyze_cwe import analyzeCwe
from analyze_cwe_in_critical import analyzeCweInCritical
from analyze_cwe_relation import analyzeCweRelation
from analyze_diff_of_producer import analyzeDiffOfProducer
from analyze_huawei_severity_by_month import analyzeHuaweiSeverityByMonth
from analyze_huawei_version import analyzeHuaweiVersion
from analyze_line_change import analyzeLineChange
from analyze_pixel_severity_by_month import analyzePixelSeverityByMonth
from analyze_producer import analyzeProducer
from analyze_samsung_severity_by_month import analyzeSamsungSeverityByMonth
from analyze_samsung_version import analyzeSamsungVersion
from analyze_summary import analyzeSummary
from analyze_type_by_month import analyzeTypeByMonth

if __name__ == "__main__":
    analyzeFuncsAndJson = [
        [analyzeCveCountByMonth, analyzeCveCountByMonthJson],
        [analyzeCvssScoreByMonth, analyzeCvssScoreByMonthJson],
        [analyzeAndroidSeverityByMonth, analyzeAndroidSeverityByMonthJson],
        [analyzePixelSeverityByMonth, analyzePixelSeverityByMonthJson],
        [analyzeHuaweiSeverityByMonth, analyzeHuaweiSeverityByMonthJson],
        [analyzeSamsungSeverityByMonth, analyzeSamsungSeverityByMonthJson],
        [analyzeTypeByMonth, analyzeTypeByMonthJson],
        [analyzeCwe, analyzeCweJson],
        [analyzeCweInCritical, analyzeCweInCriticalJson],
        [analyzeCweRelation, analyzeCweRelationJson],
        [analyzeAosp, analyzeAospJson],
        [analyzeHuaweiVersion, analyzeHuaweiVersionJson],
        [analyzeSamsungVersion, analyzeSamsungVersionJson],
        [analyzeProducer, analyzeProducerJson],
        [analyzeSummary, analyzeSummaryJson],
        [analyzeLineChange, analyzeLineChangeJson],
        [analyzeAndroidStackLayer, analyzeAndroidStackLayerJson],
        [analyzeDiffOfProducer, analyzeDiffOfProducerJson],
    ]
    analyseMasks = [True, True, True, True, True, True, True, True, True]
    for i in range(min(len(analyzeFuncsAndJson), len(analyseMasks))):
        cveList = loadAll(jsonForAnalyze)
        if not analyseMasks[i]:
            continue

        func = analyzeFuncsAndJson[i][0]
        data = func(cveList)
        jsonDump(analyzeFuncsAndJson[i][1], data)

from analyzer.src.utils.get_date_map_to_cve_sub_list import getDateMapToCveSubList

def analyzeHuaweiSeverityByMonth(cveList):
	allCnt = 0
	x = ['LOW', 'MEDIUM', 'HIGH', 'CRITICAL']
	sevMap = {'LOW': 0, 'MEDIUM': 1, 'HIGH': 2, 'CRITICAL': 3, 'CRITICAL*': 3}
	y = [0] * 4
	key = 'huaweiSeverity'
	dateMapToCveSubList = getDateMapToCveSubList(cveList)
	yByMonth = []
	for date, cveSubList in dateMapToCveSubList:
		curY = [0] * 4
		for cveDict in cveSubList:
			val = cveDict[key]
			if val:
				val = val.upper()
				allCnt += 1
				y[sevMap[val]] += 1
				curY[sevMap[val]] += 1
		yByMonth.append([date, curY])
	dataByMonth = list(zip(*yByMonth))
	dataByMonth[1] = list(zip(*dataByMonth[1]))
	return {'cveWithHuaweiSeverityCount': allCnt, 'generalData': [x, y], 'dataByMonth': dataByMonth}
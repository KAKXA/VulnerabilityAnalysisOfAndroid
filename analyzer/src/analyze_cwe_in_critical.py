from analyzer.src.utils.check_is_critical import isCritical
from analyzer.src.utils.get_all_cwe_list import getAllCweList

def analyzeCweInCritical(cveList):
	allCnt = 0
	allCweList = getAllCweList(cveList)
	x = allCweList
	cweMap = dict()
	for i, cwe in enumerate(allCweList):
		cweMap[cwe] = i
	yCritical = [0] * len(x)
	key = 'cweIds'

	for cveDict in cveList:
		if isCritical(cveDict):
			allCnt += 1
			val = cveDict[key]
			if val:
				for cweId in val:
					cweId = cweId.upper()
					yCritical[cweMap[cweId]] += 1
	return {'cveWithCwe': allCnt, 'allData': [x, yCritical]}
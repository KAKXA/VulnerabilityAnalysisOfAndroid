from collections import defaultdict

def analyzeAosp(cveList):
	versionMapToCnt = defaultdict(int)
	allCnt = 0
	for cveDict in cveList:
		if cveDict['affectedAospVersions']:
			allCnt += 1
			for version in cveDict['affectedAospVersions']:
				versionMapToCnt[version] += 1
	versionMapToCntList = [[key, val] for key, val in versionMapToCnt.items()]
	versionMapToCntList.sort(key=lambda x: [int(i) for i in x[0].split('.')])
	return {'countOfCveThatAffectAosp': allCnt, 'data': list(zip(*versionMapToCntList))}

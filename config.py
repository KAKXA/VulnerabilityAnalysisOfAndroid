import os
import json
from collections import defaultdict

domain = 'https://source.android.com'
androidBulletinUrl = "https://source.android.com/security/bulletin"
resources = "scraper/src/resources"
bulletinHtml = os.path.join(resources, "bulletin.html")
androidBulletinDivClass = "devsite-article-body clearfix"
divClass = "devsite-article-body clearfix"
androidBulletinJson = 'scraper/src/resources/android_bulletin_model.json'

androidBulletinsDirectory = os.path.join(resources, 'bulletins')

# CVE #########################
types = {'RCE', 'EOP', 'ID', 'DOS'}
referencePrefix = {'A','QC','M','N','B','U'}
severities = {'CRITICAL','HIGH','MODERATE','LOW','NSI'}
aospVersionPattern = '\d+[\\.\d*]*[ AND BELOW]?'
aospVersionPatternsAndSplitPatterns = [
    ['\d+[\\.\d+]*', 'NOSP'], # no need to split in this kind of pattern
    ['\d+[\\.\d+]*L', 'NOSP'], # no need to split in this kind of pattern
    ['\d+[\\.\d+]* AND \d+[\\.\d+]*', ' AND '],
    ['\d+[\\.\d+]* - \d+[\\.\d+]*', 'NOSP'], # deal with it after all versions are get
    ['\d+[\\.\d+]* AND BELOW', 'NOSP'] # deal with it after all versions are get
]
col2MethodName = defaultdict(str)
col2MethodName['CVE']='setCveId'
col2MethodName['REFERENCES']='setReferences'
col2MethodName['BUG WITH AOSP LINKS']='setReferences'
col2MethodName['BUG(S) WITH AOSP LINKS']='setReferences'
col2MethodName['TYPE']='setType'
col2MethodName['SEVERITY']='setSeverity'
col2MethodName['UPDATED AOSP VERSIONS']='setUpdatedAospVersions'
col2MethodName['AFFECTED VERSIONS']='setUpdatedAospVersions'
col2MethodName['COMPONENTS']='setComponent'

cveDatabase = 'testCve'
# CVE #########################

with open('config.json', 'r') as fp:
    allConf = json.load(fp)
    cveDbConf = allConf[cveDatabase]

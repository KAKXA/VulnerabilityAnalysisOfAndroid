from utils.column_map import columnMap
from utils.merge_two_dict import mergeAftToBef
from scraper.src.get_cve_details import getOneCveDetail

def fillCveSummary(cveList):
    for cveDict in cveList:
        if not cveDict['summary']:
            try:
                cveDetailsDict = getOneCveDetail(cveDict['cveId'])
            except ValueError:
                continue
            cveDetailsAfterColumnMap = columnMap('cveDetailsJson', cveDetailsDict)
            mergeAftToBef(cveDict, cveDetailsAfterColumnMap)
            print(cveDict['cveId'] + "'s details are done.")
    return cveList


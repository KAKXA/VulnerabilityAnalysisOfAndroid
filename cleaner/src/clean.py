import json
from xml.dom import NotFoundErr

from config import *
from merge import merge
from clean_references import cleanRefs
from cleaner.src.utils.load import loadAll
from cleaner.src.fill_cve_summary import fillCveSummary
            
if __name__ == "__main__":

    processes = [False, False, True]

    if processes[0]:
        afterMergeCveList = merge()
        with open(afterMergeJson, 'w') as fp:
            json.dump(afterMergeCveList, fp)

    if processes[1]:
        afterFillCveSummary = fillCveSummary(loadAll(afterMergeJson))
        with open(afterFillCveSummaryJson, 'w') as fp:
            json.dump(afterFillCveSummary, fp)

    if processes[2]:
        afterCleanRefs = cleanRefs(loadAll(afterFillCveSummaryJson))
        with open(afterCleanRefsJson, 'w') as fp:
            json.dump(afterCleanRefs, fp)

import re

def cleanRefsAndCweList(cveList):
    for cveDict in cveList:
        if cveDict['references']:
            newRefs = []
            for ref in cveDict['references']:
                if ref:
                    splitRes = re.split(', *| *,|\s', ref)
                    newRefs.extend(splitRes)
            cveDict['references'] = newRefs

        if cveDict['cweIds']:
            cweIds = cveDict['cweIds']
            cveDict['cweIds'] = []

            tmpList = cweIds.split(',')
            for i in tmpList:
                if i.isdecimal():
                    cveDict['cweIds'].append(i)
    return cveList
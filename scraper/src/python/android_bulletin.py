import json

from numpy import obj2sctype
from config import *
from utils import get_html, json_dump
from bs4 import BeautifulSoup
from model.android_bulletin_model import AndroidBulletinModel


# get bs
html = get_html.getHtml(androidBulletinUrl, bulletinHtml)
bs = BeautifulSoup(html, features="html.parser")

# find div->table->tr->td
div = bs.find("div", class_=divClass)
table = div.find(name="table")
bulletins = []
for tr in table.find_all(name="tr"):
    cnt = 0
    path = ''
    dateStr = ''
    for td in tr.find_all(name='td'):
        if cnt == 0:
            path = td.find('a').get('href')
        elif cnt == 2:
            dateStr = td.get_text()
        cnt += 1
    if dateStr != '':
        bulletins.append(AndroidBulletinModel(path, dateStr))


json_dump.jsonDump('scraper/src/resources/android_bulletin_model.json', bulletins)
from config import *
from bs4 import BeautifulSoup
from utils import get_html, json_dump
from model.android_bulletin_model import AndroidBulletinModel


def getAndroidBulletin():
    # get bs
    html = get_html.getHtml(androidBulletinUrl, androidBulletinHtml)
    bs = BeautifulSoup(html, features='html.parser')

    # find div->table->tr->td
    div = bs.find('div', class_=divClass)
    table = div.find(name='table')
    bulletins = []
    for tr in table.find_all(name='tr'):
        cnt = 0
        path = ''
        dateStr = ''
        for td in tr.find_all(name='td'):
            if cnt == 0:
                path = td.find('a').get('href')
            elif cnt == 2:
                dateStr = td.get_text()
            cnt += 1
        if dateStr != '':
            bulletins.append(AndroidBulletinModel(path.split('/')[-1], dateStr))


    json_dump.jsonDump(androidBulletinJson, bulletins)

if __name__ == '__main__':
    getAndroidBulletin()